import{r as l,j as e,a as u,L as ot,g as J,c as He,d as at,b as G,S as me,e as ye,C as st,u as it,f as ct,Q as V}from"./index-3285fa8f.js";import{A as dt,u as Oe,P as Se,C as Ne,D as ne,g as ut,a as ht}from"./Document-69b6f541.js";import{u as mt}from"./index.esm-91f740c5.js";const pt=t=>{l.useEffect(()=>{!document||!t||document.title===t||(document.title=t)},[t])},gt="_header_1qudc_1",_t="_logo_1qudc_12",Re={header:gt,logo:_t},ft=({user:t,title:n,children:o,logout:i,toggleTitle:h})=>e(l.Fragment,{children:u("div",{className:Re.header,children:[u("div",{className:Re.logo,children:[e(ot,{to:"/document/list",children:e("img",{src:J("/logo.png")})}),e("span",{onClick:h,children:n})]}),o,e(dt,{user:t,logout:i})]})}),vt="_enter_1a00t_1",bt="_menu_1a00t_1",wt="_fadeIn_1a00t_1",kt="_exit_1a00t_5",Lt="_container_1a00t_9",ce={enter:vt,menu:bt,fadeIn:wt,exit:kt,container:Lt},se=({selector:t,children:n,className:o,placement:i="top",...h})=>{let[a,m]=l.useState(null),[c,g]=l.useState(null),[_,b]=l.useState(!1);const{attributes:$,styles:d}=Oe(a,c,{placement:i,modifiers:[{name:"offset",options:{offset:[0,10]}}]}),S=()=>{b(!0)},E=()=>{b(!1)};return l.useEffect(()=>{if(t.length===0)return;let v=document.querySelector(t);v&&(v.onmouseenter=S,v.onmouseleave=E,m(v))},[t]),e(Se,{children:e(Ne,{in:_,timeout:300,classNames:{enterActive:ce.enter,exitActive:ce.exit},unmountOnExit:!0,children:e("div",{ref:g,className:`${ce.container} ${o||""}`.trim(),style:{...d.popper},...$.popper,...h,children:e("div",{className:ce.menu,children:n})})})})},xt="_enter_10q2k_1",Ct="_fadeIn_10q2k_1",$t="_exit_10q2k_5",Ie={enter:xt,fadeIn:Ct,exit:$t},pe=({children:t,selector:n,isOpen:o,placement:i="right",toggle:h,...a})=>{let[m,c]=l.useState(null),[g,_]=l.useState(null);const{attributes:b,styles:$}=Oe(m,g,{placement:i,modifiers:[{name:"offset",options:{offset:[0,10]}}]});l.useLayoutEffect(()=>{let S=document.querySelector(n);S&&c(S)},[]);const d=S=>{S&&He({ref:S,onClose:h,doNotClose:E=>m?m.contains(E):!1})};return e(Se,{children:e(Ne,{in:o,timeout:200,unmountOnExit:!0,classNames:{enterActive:Ie.enter,exitActive:Ie.exit},onEntered:d,children:e("div",{ref:_,style:{...$.popper},...b.popper,...a,children:t})})})};let he=[{label:"Circle",type:"circle",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,20 C7.581722,20 4,16.418278 4,12 C4,7.581722 7.581722,4 12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z"})]})},{label:"Square",type:"square",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M2,2 L22,2 L22,22 L2,22 L2,2 Z M4,4 L4,20 L20,20 L20,4 L4,4 Z"})]})},{label:"Triangle",type:"triangle",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M2,22 L11.99,2 L22,22 L2,22 Z M11.9917889,6.47213631 L5.23462094,20 L18.7624846,20 L11.9917889,6.47213631 Z"})]})},{label:"Diamond",type:"diamond",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M2,12 L11.99,2 L22,12 L11.99,22 L2,12 Z M11.9914142,19.1715725 L19.1701583,12 L11.9914142,4.82842748 L4.82701326,12 L11.9914142,19.1715725 Z"})]})},{label:"Arrow",type:"arrow",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M12,2 L12,5.33333333 L2,5.33333333 L2,18.6666667 L12,18.6666667 L12,22 L22,11.9901333 L12,2 Z M19.1715725,11.9915287 L14,17.1682038 L14,16.6666667 L4,16.6666667 L4,7.33333333 L14,7.33333333 L14,6.82505878 L19.1715725,11.9915287 Z"})]})},{label:"Rectangle",type:"rectangle",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{strokeWidth:"1",d:"M2,7 L22,7 L22,17 L2,17 L2,7 Z M4,9 L4,15 L20,15 L20,9 L4,9 Z"})]})}],yt=[{label:"sketch",svg:void 0},{label:"Erase",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{d:"M17.26 18l-2 2h6.7v-2h-4.7zm4.15-6.67L13.04 20H4.73l-2.15-2.14c-.78-.78-.78-2.03 0-2.82L13.62 3.58c.78-.77 2.06-.77 2.84 0l4.95 4.93c.79.78.79 2.04 0 2.82z"})]})},{label:"Select",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("polygon",{points:"12.926 12 17.5 20 15 21.5 10.405 13.595 6 18 6 2 19 12"})]})},{label:"Sticky note",svg:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:e("path",{d:"M20,16V4H4v16h12v-2c0-1.1,0.9-2,2-2H20z M4,2h16c1.1,0,2,0.9,2,2v13l-5,5H4c-1.1,0-2-0.9-2-2V4 C2,2.9,2.9,2,4,2z M7,8h10v2H7V8z M7,12h6v2H7V12z"})})},{label:"shape",svg:void 0},{label:"Text Box",svg:e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:e("path",{style:{strokeWidth:1},d:"M21,17 L23,17 L23,23 L17,23 L17,21 L7,21 L7,23 L1,23 L1,17 L3,17 L3,7 L1,7 L1,1 L7,1 L7,3 L17,3 L17,1 L23,1 L23,7 L21,7 L21,17 Z M21,19 L19,19 L19,21 L21,21 L21,19 Z M17,19 L17,17 L19,17 L19,7 L17,7 L17,5 L7,5 L7,7 L5,7 L5,17 L7,17 L7,19 L17,19 Z M21,5 L21,3 L19,3 L19,5 L21,5 Z M5,21 L5,19 L3,19 L3,21 L5,21 Z M3,5 L5,5 L5,3 L3,3 L3,5 Z M13,10 L13,16 L11,16 L11,10 L8,10 L8,8 L16,8 L16,10 L13,10 Z",fillRule:"nonzero"})})}],Be=[{label:"Pen",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M24 0v24H0V0h24z"}),e("path",{d:"M3 17.25V21h3.74l7.54-7.53-3.75-3.75L3 17.25zM18.37 3.3l2.34 2.33c.39.39.4 1.03.01 1.42l-5.37 5.36-3.76-3.76 2.53-2.53-.73-.73-5.66 5.66-1.4-1.4 6.37-6.36c.39-.39 1.04-.38 1.42.01l1.42 1.41 1.42-1.41c.38-.39 1.02-.39 1.41 0z"})]})},{label:"Marker",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M0 0h24v24H0V0z"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.7 9.49l4.29 4.3-6.54 6.54-.72-.72-1.43 1.43c-.79.79-2.07.79-2.86 0s-.79-2.08 0-2.86l1.43-1.43-.72-.72L9.7 9.49zm11.56-5.8L19.8 2.22c-.78-.78-2.05-.78-2.83 0l-6.21 6.21 4.29 4.3 6.21-6.21c.79-.78.79-2.05 0-2.83z"})]})},{label:"Highlighter",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:[e("path",{fill:"none",d:"M0 0h24v24H0V0z"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.22 9.49l-5.91 6c-.77.8-.7 2.05.08 2.85L.77 22h5.68l.74-.75c.78.81 1.95.86 2.73.05l5.96-6.05-5.66-5.76zm12.46-4l-2.82-2.87c-.78-.8-2.07-.84-2.84-.04l-5.75 5.85 5.66 5.75 5.69-5.78c.77-.81.83-2.11.06-2.91z"})]})},{label:"Brush",svg:u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",viewBox:"0 0 24 24",children:[e("path",{d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M7 14c-1.66 0-3 1.34-3 3 0 1.31-1.16 2-2 2 .92 1.22 2.49 2 4 2 2.21 0 4-1.79 4-4 0-1.66-1.34-3-3-3zm13.71-9.37l-1.34-1.34c-.39-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.02 0-1.41z"})]})}],ge=[{label:"Black",colorCode:"#262626",lightColorCode:"#b1b3b4"},{label:"Blue",colorCode:"#19ACC0",lightColorCode:"#99dee6"},{label:"Green",colorCode:"#699E3E",lightColorCode:"#c3d9af"},{label:"Yellow",colorCode:"#F3B32A",lightColorCode:"#fbe199"},{label:"Red",colorCode:"#D9453C",lightColorCode:"#f1b4af"},{label:"White",colorCode:"#FFFFFF",lightColorCode:"#FFFFFF"}];const St=[{label:"Default",bgCode:"default"},{label:"Dots",bgCode:"dots"},{label:"Blue line",bgCode:"blue-line"},{label:"Blue graph",bgCode:"blue-graph"},{label:"Gray graph",bgCode:"gray-graph"},{label:"Blueboard",bgCode:"blue-board"},{label:"Chalkboard",bgCode:"chalk-board"}],Nt="_container_kg945_1",Mt="_sketch_kg945_6",zt="_color_kg945_7",Dt="_active_kg945_20",Le={container:Nt,sketch:Mt,color:zt,active:Dt},Et=({isOpen:t,sketch:n,sketchColor:o,toggle:i,onSelectSketch:h,onSelectSketchColor:a})=>{let m=c=>{a(c),i()};return e(pe,{className:Le.container,isOpen:t,selector:"#sketches",toggle:i,children:e("div",{className:Le.color,children:ge.map(({label:c,colorCode:g},_)=>{let b=_===o?Le.active:void 0;return u(l.Fragment,{children:[e("button",{id:`color-${_}`,className:b,onClick:()=>m(_),children:e("span",{style:{backgroundColor:g}})}),e(se,{selector:`#color-${_}`,placement:"bottom",children:c})]},_)})})})},Rt="_container_16s3w_1",It="_shape_16s3w_6",Bt="_active_16s3w_21",Fe={container:Rt,shape:It,active:Bt},Ft=({shape:t,isOpen:n,toggle:o,onSelectShape:i})=>{let h=a=>{i(a),o()};return e(pe,{className:Fe.container,isOpen:n,selector:"#shapes",toggle:o,children:e("div",{className:Fe.shape,children:he.map(({label:a,svg:m},c)=>u(l.Fragment,{children:[e("button",{id:`shape-${c}`,onClick:()=>h(c),children:m}),e(se,{selector:`#shape-${c}`,placement:"bottom",children:a})]},c))})})},qt="_container_xh1kp_1",At="_bg_xh1kp_6",Ht="_active_xh1kp_30",xe={container:qt,bg:At,active:Ht},Ot=({background:t,isOpen:n,toggle:o,onSelectBackGround:i})=>{let h=a=>{i(a),o()};return e(pe,{className:xe.container,isOpen:n,selector:"#backgrounds",placement:"bottom-start",toggle:o,children:e("div",{className:xe.bg,children:St.map(({label:a,bgCode:m},c)=>{let g=t===m;return u(l.Fragment,{children:[e("button",{id:`background-${c}`,onClick:()=>h(m),className:g?xe.active:void 0,style:{"--bg":`url(${J(`/background-icon/${m}.svg`)})`},children:g&&e("img",{src:J("/check.svg")})}),e(se,{selector:`#background-${c}`,placement:"bottom",children:a})]},c)})})})},Tt="_container_1xzpo_1",Yt="_color_1xzpo_6",Zt="_active_1xzpo_18",Ce={container:Tt,color:Yt,active:Zt},qe=({id:t,isOpen:n,color:o,toggle:i,onSelectColor:h})=>{let a=m=>{h(m),i()};return e(pe,{id:`${t}-dropdown`,className:Ce.container,isOpen:n,selector:`#${t}`,placement:"bottom-start",toggle:i,children:e("div",{className:Ce.color,children:ge.map(({label:m,colorCode:c,lightColorCode:g},_)=>{let b=t==="background"?g:c,$=b===o?Ce.active:void 0;return u(l.Fragment,{children:[e("button",{id:`${t}-${_}`,className:$,onClick:()=>a(b),children:e("span",{style:{backgroundColor:b}})}),e(se,{selector:`#${t}-${_}`,placement:"bottom",children:m})]},_)})})})},Vt="_container_8wfdu_1",Xt="_active_8wfdu_29",Wt="_toolbar_8wfdu_54",Gt="_zoom_in_8wfdu_65",Ut="_zoom_out_8wfdu_66",Pt="_redo_8wfdu_69",jt="_undo_8wfdu_70",Jt="_background_btn_8wfdu_86",Qt="_clear_btn_8wfdu_87",Kt="_separator_8wfdu_90",en="_color_btn_8wfdu_95",O={container:Vt,active:Xt,toolbar:Wt,zoom_in:Gt,zoom_out:Ut,redo:Pt,undo:jt,background_btn:Jt,clear_btn:Qt,separator:Kt,color_btn:en},tn=({tool:t,sketch:n,shape:o,sketchColor:i,slideBackGround:h,borderColor:a,backgroundColor:m,selectedShapeId:c,onClearSlide:g,onSelectTool:_,onSelectShape:b,onSelectSketch:$,onSelectSketchColor:d,onSelectBackGround:S,onSelectBorderColor:E,onSelectBackGroundColor:v})=>{let[f,R]=l.useState(!1),[C,T]=l.useState(!1),[A,Y]=l.useState(!1),[w,y]=l.useState(!1),[k,D]=l.useState(!1),H=()=>{Y(!A)},L=()=>{R(!f)},X=()=>{T(!C)},z=()=>{D(!k)},N=()=>{y(!w)},U=(x,B)=>{(B==="shape"||B==="sketch")&&t===x&&(B==="shape"?L():B==="sketch"&&X()),t!==x&&_(x)};return u(l.Fragment,{children:[u("div",{className:O.toolbar,children:[e("button",{className:O.redo,disabled:!0,children:e("i",{className:"bx-undo"})}),e("button",{className:O.undo,disabled:!0,children:e("i",{className:"bx-redo"})}),e("div",{className:O.separator}),e("button",{className:O.zoom_out,children:e("i",{className:"bx-zoom-out"})}),e("button",{className:O.zoom_in,children:e("i",{className:"bx-zoom-in"})}),e("div",{className:O.separator}),t!==4&&t!==5&&!c&&u(l.Fragment,{children:[e("button",{id:"backgrounds",className:O.background_btn,onClick:H,children:"Set background"}),e("div",{className:O.separator}),e("button",{className:O.clear_btn,onClick:g,children:"Clear frame"})]}),(t===4||c)&&u("div",{className:O.color_btn,children:[e("button",{id:"border",onClick:N,style:{"--bg":a},children:e("i",{className:"bxs-pencil"})}),e("button",{id:"background",onClick:z,style:{"--bg":m},children:e("i",{className:"bxs-color-fill"})})]})]}),e("div",{className:O.container,children:yt.map(({label:x,svg:B},P)=>{let _e=x==="shape"?he[o].svg:x==="sketch"?Be[n].svg:B,fe=x==="shape"?he[o].label:x==="sketch"?Be[n].label:x,ve=P===t?O.active:void 0,be=x==="shape"?"shapes":x==="sketch"?"sketches":`toolbar-${P}`,we=x==="sketch"?ge[i].colorCode:void 0;return u(l.Fragment,{children:[u("button",{id:be,className:ve,onClick:()=>U(P,x),style:{"--bgColor":we},children:[_e,(x==="shape"||x==="sketch")&&e("i",{className:"bxs-right-arrow"})]}),e(se,{selector:`#toolbar-${P}`,placement:"right",children:fe})]},P)})}),f&&e(Ft,{isOpen:f,shape:o,toggle:L,onSelectShape:b}),C&&e(Et,{isOpen:C,sketch:n,sketchColor:i,toggle:X,onSelectSketch:$,onSelectSketchColor:d}),A&&e(Ot,{isOpen:A,background:h,toggle:H,onSelectBackGround:S}),w&&e(qe,{id:"border",isOpen:w,color:a,toggle:N,onSelectColor:x=>E("borderColor",x)}),k&&e(qe,{id:"background",isOpen:k,color:m,toggle:z,onSelectColor:x=>v("backgroundColor",x)})]})},nn="_sketch_board_1qh03_1",rn={sketch_board:nn},ln=({tool:t,sketch:n,sketchColor:o,canvas:i,dimension:h,isActiveSlide:a=!1,onUpdateCanvas:m})=>{let c=l.useRef(null),g=l.useRef(null),_=l.useRef(null);l.useEffect(()=>{i.image&&S()},[]),l.useEffect(()=>{if(!c.current)return;g.current=c.current.getContext("2d");let v=document.querySelector(`[mini-canvas='${i._id}']`);v&&(_.current=v.getContext("2d"))},[]),l.useEffect(()=>{g.current.strokeStyle=t===6?"#FF3131":ge[o].colorCode,g.current.lineWidth=5,g.current.lineCap="round",g.current.lineJoin="round"},[o,t]);let b=({pageX:v,pageY:f})=>{if(!c.current||!g.current)return;let{left:R,top:C,width:T,height:A}=c.current.getBoundingClientRect(),Y=h.width/T,w=h.height/A,y=(v-R)*Y,k=(f-C)*w;g.current.beginPath(),g.current.moveTo(y,k),_.current&&(_.current.beginPath(),_.current.moveTo(y,k)),window.addEventListener("mousemove",$),window.addEventListener("mouseup",d,{once:!0})},$=({x:v,y:f})=>{if(!c.current||!g.current)return;let{left:R,top:C,width:T,height:A}=c.current.getBoundingClientRect(),Y=h.width/T,w=h.height/A,y=(v-R)*Y,k=(f-C)*w;t===0||t==6?(g.current.lineTo(y,k),g.current.stroke(),_.current&&(_.current.lineTo(y,k),_.current.stroke())):t===1&&(g.current.clearRect(y,k,20,20),_.current&&_.current.clearRect(y,k,20,20))},d=()=>{c.current&&(window.removeEventListener("mousemove",$),c.current.toBlob(v=>{v&&m(i._id,v)},"image/png"))},S=()=>{let v=new Image;v.src=`data:image/png;base64,${i.image}`,v.onload=()=>{g.current&&(g.current.drawImage(v,0,0),_.current&&_.current.drawImage(v,0,0))}},E=v=>{[0,1,6].includes(t)&&v.preventDefault()};return e("canvas",{ref:c,className:rn.sketch_board,width:h.width,height:h.height,"data-canvas":i._id,style:{pointerEvents:[0,1,6].includes(t)?"auto":"none"},onContextMenu:E,...[0,1,6].includes(t)&&a&&{onMouseDown:b}})},Te=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("ellipse",{cx:t/2,cy:n/2,rx:t/3,ry:n/3,style:{stroke:o,fill:i}})}),Ye=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("path",{d:`M${t/2} ${n} L${t/2} ${n} L0 ${n/2} L${t/2} 0 L${t} ${n/2} Z`,style:{stroke:o,fill:i}})}),Ze=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("path",{d:`M0 0 L0 0 L0 ${n} L${t} ${n} L${t} 0 Z`,style:{stroke:o,fill:i}})}),Ve=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("path",{d:`M0 0 L0 0 L0 ${n} L${t} ${n} L${t} 0 Z`,style:{stroke:o,fill:i}})}),Xe=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("path",{d:`M${t} ${n} L${t} ${n} L0 ${n} L${t/2} 0 Z`,style:{stroke:o,fill:i}})}),We=({width:t,height:n,borderColor:o,backgroundColor:i})=>e("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",overflow:"visible",children:e("path",{d:`M${t} ${n/2} L${t} ${n/2} L${t/2} 0 L${t/2} ${n/6} L0 ${n/6} L0 ${n-n/6} L${t/2} ${n-n/6} L${t/2} ${n} Z`,style:{stroke:o,fill:i}})}),on="_container_tfnie_1",an={container:on},Ge=({text:t,...n})=>e("div",{className:an.container,...n,children:e("h2",{children:t})}),sn="_field_ak0ir_1",cn={field:sn},Ue=({readOnly:t,...n})=>{let o=l.useRef(null);return l.useEffect(()=>{!o.current||t||o.current.focus()},[t]),e("textarea",{ref:o,className:cn.field,readOnly:t,...n})},dn="_container_cn33k_1",un="_top_start_cn33k_37",hn="_bottom_start_cn33k_38",mn="_bottom_end_cn33k_39",pn="_top_cn33k_37",gn="_bottom_cn33k_38",_n="_left_cn33k_54",fn="_right_cn33k_55",vn="_top_end_cn33k_83",W={container:dn,top_start:un,bottom_start:hn,bottom_end:mn,top:pn,bottom:gn,left:_n,right:fn,top_end:vn},bn=({shapeId:t,shapeProps:n,shapeRef:o,onClose:i,onMouseDown:h,onReset:a})=>{let m=l.useRef(null);l.useEffect(()=>{if(!o)return;let d=He({ref:o,onClose:i,doNotClose:S=>{if(!m.current||!o)return;let v=[...document.querySelectorAll("#border,#background,#border-dropdown,#background-dropdown")].some(f=>f.contains(S));return m.current.contains(S)||o.contains(S)||v}});return()=>{d(),a()}},[]);let{width:c,height:g,translateX:_,translateY:b,rotate:$}=n;return u("div",{ref:m,className:W.container,style:{width:`${c+30}px`,height:`${g+30}px`,transform:`translate(${_}px, ${b}px) rotate(${$}deg)`},children:[e("button",{className:W.top_start,onMouseDown:d=>h(d,"rotate"),children:e("img",{src:J("/rotate.svg"),alt:"",draggable:!1})}),e("button",{className:W.top,onMouseDown:d=>h(d,"top")}),e("button",{"shape-id":t,className:W.top_end,children:e("i",{className:"bx-dots-vertical-rounded"})}),e("button",{className:W.left,onMouseDown:d=>h(d,"left")}),e("button",{className:W.right,onMouseDown:d=>h(d,"right")}),e("button",{className:W.bottom_start,onMouseDown:d=>h(d,"bottom-start")}),e("button",{className:W.bottom,onMouseDown:d=>h(d,"bottom")}),e("button",{className:W.bottom_end,onMouseDown:d=>h(d,"bottom-end")})]})},wn="_container_1igfo_1",kn="_overlay_1igfo_7",$e={container:wn,overlay:kn},Ln=({shape:t,selectedShapeId:n,onClick:o,onBlur:i,onUpdateShape:h})=>{let[a,m]=l.useState(null),[c,g]=l.useState(!0),_=l.useRef(null),b=l.useRef(null),$=at(w=>h(w),1e3);l.useEffect(()=>{m(t.props)},[t.props]);let d=({target:{value:w,scrollHeight:y}})=>{if(!a)return;let k={...a,height:y,text:w};$({_id:t._id,props:k}),m(k)},S=l.useMemo(()=>{if(!a)return null;let{width:w,height:y,borderColor:k,backgroundColor:D,color:H,text:L}=a;switch(t.type){case"sticky-note":return e(Ge,{text:"Hello World",style:{borderColor:k,backgroundColor:D,color:H}});case"text-box":return e(Ue,{defaultValue:L,readOnly:c,onChange:d});case"arrow":return e(We,{width:w,height:y,borderColor:k,backgroundColor:D});case"circle":return e(Te,{width:w,height:y,borderColor:k,backgroundColor:D});case"diamond":return e(Ye,{width:w,height:y,borderColor:k,backgroundColor:D});case"rectangle":return e(Ze,{width:w,height:y,borderColor:k,backgroundColor:D});case"square":return e(Ve,{width:w,height:y,borderColor:k,backgroundColor:D});case"triangle":return e(Xe,{width:w,height:y,borderColor:k,backgroundColor:D});default:return null}},[t.type,a==null?void 0:a.width,a==null?void 0:a.height,a==null?void 0:a.backgroundColor,a==null?void 0:a.borderColor,a==null?void 0:a.color,c]),E=({x:w,y})=>{if(!a||!b.current||!_.current)return;let{pageX:k,pageY:D,type:H}=b.current,L={...a},{width:X,height:z}=_.current.parentElement.getBoundingClientRect(),{clientWidth:N,clientHeight:U}=_.current.parentElement,x=N/X,B=U/z;switch(H){case"move":L.translateX+=(w-k)*x,L.translateY+=(y-D)*B;break;case"rotate":break;case"left":L.translateX+=(w-k)*x,L.width+=-(w-k)*x;break;case"right":L.width+=(w-k)*x;break;case"bottom":L.height+=(y-D)*B;break;case"top":L.translateY+=(y-D)*B,L.height+=-(y-D)*B;break;case"bottom-start":L.translateX+=(w-k)*x,L.width+=-(w-k)*x,L.height+=(y-D)*B;break;case"bottom-end":L.width+=(w-k)*x,L.height+=(y-D)*B;break;default:return}H==="move"?(L.translateX=Math.max(0,Math.min(N-L.width,L.translateX)),L.translateY=Math.max(0,Math.min(U-L.height,L.translateY))):(L.width=Math.min(N-L.translateX,Math.max(125,L.width)),L.height=Math.min(U-L.translateY,Math.max(125,L.height))),m(L)},v=()=>{window.removeEventListener("mouseup",R),window.removeEventListener("mousemove",E)},f=()=>{window.addEventListener("mouseup",R),window.addEventListener("mousemove",E)},R=()=>{v(),b.current=null,m(w=>(w&&h({_id:t._id,props:w}),w))},C=(w,y)=>{w.stopPropagation();let{pageX:k,pageY:D}=w;b.current={type:y,pageX:k,pageY:D},f()},T=()=>{(t.type==="sticky-note"||t.type==="text-box")&&g(!1)},A=()=>{o(t._id)},Y=()=>{c||g(!0)};return a?u(l.Fragment,{children:[u("div",{ref:_,className:$e.container,onClick:A,style:{width:`${a.width}px`,height:`${a.height}px`,transform:`translate(${a.translateX}px, ${a.translateY}px) rotate(${a.rotate}deg)`},children:[S,t._id===n&&e("div",{className:$e.overlay,onDoubleClick:T,onMouseDown:w=>C(w,"move"),style:{cursor:c?"move":"default",pointerEvents:c?"auto":"none"}})]}),t._id===n&&e(bn,{shapeId:t._id,shapeProps:a,shapeRef:_.current,onClose:i,onMouseDown:C,onReset:Y})]}):null},Pe=({shape:t})=>{let[n,o]=l.useState(null);l.useEffect(()=>{o(t.props)},[t.props]);let i=l.useMemo(()=>{if(!n)return null;let{width:h,height:a,backgroundColor:m,borderColor:c,text:g}=n;switch(t.type){case"sticky-note":return e(Ge,{text:"Hello World"});case"text-box":return e(Ue,{defaultValue:g,readOnly:!0});case"arrow":return e(We,{width:h,height:a,borderColor:c,backgroundColor:m});case"circle":return e(Te,{width:h,height:a,borderColor:c,backgroundColor:m});case"diamond":return e(Ye,{width:h,height:a,borderColor:c,backgroundColor:m});case"rectangle":return e(Ze,{width:h,height:a,borderColor:c,backgroundColor:m});case"square":return e(Ve,{width:h,height:a,borderColor:c,backgroundColor:m});case"triangle":return e(Xe,{width:h,height:a,borderColor:c,backgroundColor:m});default:return null}},[t.type,n==null?void 0:n.width,n==null?void 0:n.height,n==null?void 0:n.backgroundColor,n==null?void 0:n.borderColor]);return n?e("div",{className:$e.container,style:{width:`${n.width}px`,height:`${n.height}px`,transform:`translate(${n.translateX}px, ${n.translateY}px) rotate(${n.rotate}deg)`},children:i}):null},xn="_container_d2zqk_1",Cn="_slide_icon_d2zqk_10",$n="_navigate_btn_d2zqk_29",yn="_slides_d2zqk_53",Sn="_slide_list_d2zqk_66",Nn="_slide_d2zqk_10",Mn="_active_d2zqk_80",zn="_board_d2zqk_83",Dn="_add_btn_d2zqk_112",En="_slide_dropdown_d2zqk_146",q={container:xn,slide_icon:Cn,navigate_btn:$n,slides:yn,slide_list:Sn,slide:Nn,active:Mn,board:zn,add_btn:Dn,slide_dropdown:En};let de={width:224,height:126};const Rn=({slides:t,activeSlide:n,activeSlideId:o,dimension:i,onSlideChange:h,onAddSlide:a,onDeleteSlide:m})=>{let[c,g]=l.useState(!1),_=l.useRef(null),b=t?t.length:1,$={width:i.width/2,height:i.height/2};l.useEffect(()=>{if(_.current)return setTimeout(()=>{c?window.addEventListener("click",d):window.removeEventListener("click",d)},0),()=>{window.removeEventListener("click",d)}},[c]);let d=f=>{if(!_.current)return;let R=f.target;_.current.contains(R)||S()},S=()=>{g(!c)},E=()=>{n!==0&&h(n-1)},v=()=>{n!==b-1&&h(n+1)};return u(l.Fragment,{children:[u("div",{className:q.container,children:[e("button",{className:q.navigate_btn,disabled:n===0,onClick:E,children:e("i",{className:"bx-chevron-left"})}),u("div",{className:q.slide_icon,onClick:S,children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"46",height:"36",viewBox:"0 0 46 36",children:u("g",{fill:"none",children:[e("rect",{width:"38",height:"22",x:"1",y:"7",stroke:"#3C4043",strokeWidth:"2"}),e("path",{fill:"#5F6368",d:"M8,4 L6,4 L6,0 L46,0 L46,24 L42,24 L42,22 L44,22 L44,2 L8,2 L8,4 Z"}),e("polygon",{fill:"#80868B",points:"26 33 23 36 20 33"})]})}),u("span",{children:[n+1," / ",b]})]}),e("button",{className:q.navigate_btn,disabled:n===b-1,onClick:v,children:e("i",{className:"bx-chevron-right"})})]}),u("div",{ref:_,className:q.slides,"aria-expanded":c,children:[e("button",{className:q.navigate_btn,disabled:n===0,onClick:E,children:e("i",{className:"bx-chevron-left"})}),u("div",{className:q.slide_list,children:[e("button",{className:q.add_btn,onClick:()=>a(0),children:e("i",{className:"bx-plus"})}),t&&t.length>0&&t.map((f,R)=>u(l.Fragment,{children:[u("div",{className:`${q.slide} ${f._id===o?q.active:""}`.trim(),style:{width:`${de.width+4}px`,height:`${de.height+4}px`},"data-mini-slide":f._id,onClick:()=>h(R),children:[u("div",{className:q.board,style:{width:`${i.width}px`,height:`${i.height}px`,transform:`scale(${de.width/i.width},${de.height/i.height})`,backgroundImage:`url(/background/${J(f.props.backgroundImage)}.png)`},children:[e("canvas",{width:$.width,height:$.height,"mini-canvas":f.canvas._id}),f.shapes&&f.shapes.map(C=>e(Pe,{shape:C},C._id))]}),e("button",{id:`slide-dropdown-${f._id}`,onClick:C=>C.stopPropagation(),children:e("i",{className:"bx-dots-vertical-rounded"})})]}),e("button",{className:q.add_btn,onClick:()=>a(R+1),children:e("i",{className:"bx-plus"})}),u(ne,{selector:`#slide-dropdown-${f._id}`,className:q.slide_dropdown,placement:"bottom",children:[u(ne.Item,{children:[e("i",{className:"bx-duplicate"}),e("span",{children:"Duplicate"})]}),u(ne.Item,{onClick:()=>m(f._id),children:[e("i",{className:"bx-trash"}),e("span",{children:"Delete"})]})]})]},f._id))]}),e("button",{className:q.navigate_btn,disabled:n===b-1,onClick:v,children:e("i",{className:"bx-chevron-right"})})]})]})},In="_enter_ezio4_1",Bn="_dialog_ezio4_1",Fn="_overlay_ezio4_2",qn="_fadeIn_ezio4_1",An="_exit_ezio4_6",Hn="_fadeOut_ezio4_1",On="_container_ezio4_11",Tn="_content_ezio4_23",ee={enter:In,dialog:Bn,overlay:Fn,fadeIn:qn,exit:An,fadeOut:Hn,container:On,content:Tn},Yn=({isOpen:t,children:n,size:o="md",closeClickOnOutSide:i=!0,toggle:h})=>{let a=()=>{t&&h()};return e(Se,{children:e(Ne,{in:t,timeout:300,unmountOnExit:!0,classNames:{enterActive:ee.enter,exitActive:ee.exit},children:u("div",{children:[e("div",{className:ee.container,...i&&{onClick:a},children:e("div",{className:ee.dialog,children:e("div",{"data-size":o,className:ee.content,onClick:m=>m.stopPropagation(),children:n})})}),e("div",{className:ee.overlay})]})})})},Zn="_container_1flam_1",Vn="_title_1flam_1",Xn="_form_1flam_8",Wn="_field_1flam_17",Gn="_error_msg_1flam_35",Un="_submit_btn_1flam_47",te={container:Zn,title:Vn,form:Xn,field:Wn,error_msg:Gn,submit_btn:Un},Pn=({isOpen:t,title:n,toggle:o,onSubmit:i})=>{let{register:h,handleSubmit:a,reset:m,setValue:c,formState:{errors:g}}=mt();return l.useEffect(()=>{t||(c("title",""),m())},[t]),e(Yn,{isOpen:t,toggle:o,size:"sm",closeClickOnOutSide:!1,children:u("div",{className:te.container,children:[e("div",{className:te.title,children:e("span",{children:"Rename Jam"})}),u("div",{className:te.form,children:[e("label",{htmlFor:"title",children:"Enter a new name :"}),u("div",{className:te.field,children:[e("input",{id:"title",placeholder:"Enter title",defaultValue:n,...h("title",{required:{value:!0,message:"Please enter title"}})}),g.title&&u("div",{className:te.error_msg,children:[e("i",{className:"bx-error-circle"}),e("span",{children:g.title.message})]})]})]}),u("div",{className:te.submit_btn,children:[e("button",{onClick:a(({title:_})=>i(_)),children:"Ok"}),e("button",{onClick:o,children:"Cancel"})]})]})})},jn=(t,n)=>G({url:me.create(t),method:"post",params:n}),Jn=(t,n)=>G({url:me.delete(t),method:"delete",params:n}),Qn=(t,n)=>G({url:me.clear(t),method:"put",params:n}),Kn=(t,n,o)=>G({url:me.update(t),method:"put",params:n,data:o}),er=(t,n,o)=>G({method:"post",url:ye.create(t),params:n,data:o}),Ae=(t,n)=>G({url:ye.update(t),method:"put",data:n}),tr=(t,n)=>G({url:ye.delete(t),method:"delete",params:n}),nr=(t,n)=>G({url:st.update(t),method:"put",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:n}),rr="_container_1yo9h_1",lr="_slide_1yo9h_8",or="_board_1yo9h_13",ar="_shape_dropdown_1yo9h_23",ue={container:rr,slide:lr,board:or,shape_dropdown:ar};let j={width:3840,height:2160},ae={width:j.width/2,height:j.height/2},sr={borderColor:"#262626",backgroundColor:"#FFFFFF"};const ur=()=>{let{user:t,logout:n}=it(),[o,i]=l.useState(2),[h,a]=l.useState(1),[m,c]=l.useState(0),[g,_]=l.useState(0),[b,$]=l.useState({}),{slides:d,title:S}=b,E=l.useRef(null),v=l.useRef(null),[f,R]=l.useState(0),[C,T]=l.useState(null),[A,Y]=l.useState(null),[w,y]=l.useState(!1),[k,D]=l.useState({x:1,y:1}),[H,L]=l.useState(sr),X=l.useRef({pageX:0,pageY:0}),{documentId:z}=ct();pt(S),l.useLayoutEffect(()=>{x()},[]);let N=l.useMemo(()=>{if(!d||d.length===0)return;let r=d.find((s,p)=>p===f);if(r)return r._id},[f,d]);l.useEffect(()=>{if(!N)return;v.current=document.querySelector(`[data-slide='${N}']`),document.querySelector(`[data-mini-slide='${N}']`).scrollIntoView({behavior:"smooth",inline:"center"}),v.current.scrollIntoView({behavior:"smooth",inline:"center"})},[N]),l.useEffect(()=>(window.addEventListener("resize",x),()=>{window.removeEventListener("resize",x)}),[]),l.useEffect(()=>{U()},[z]),l.useEffect(()=>{if(!C)return;let s=d[f].shapes.find(({_id:p})=>p===C);s&&L({borderColor:s.props.borderColor,backgroundColor:s.props.backgroundColor})},[C,d,f]);let U=async()=>{if(z)try{let{data:{data:r}}=await ut(z);$(r)}catch(r){V.error(r==null?void 0:r.message)}},x=()=>{if(!E.current)return;let{clientHeight:r}=E.current,s=r-30,p=s/9*16;D({...k,x:p/j.width,y:s/j.height})},B=async()=>{if(!z||!N)return;let r=f;try{await Qn(z,{slideId:N});let s=d[r].canvas._id,p=document.querySelector(`[data-canvas='${s}']`);if(p){let I=p.getContext("2d");I&&I.clearRect(0,0,ae.width,ae.height)}let M=document.querySelector(`[mini-canvas='${s}']`);if(M){let I=M.getContext("2d");I&&I.clearRect(0,0,ae.width,ae.height)}let F={...b},Z=F.slides[f];Z.shapes=[],Z.canvas.image=null,$(F)}catch(s){V.error(s==null?void 0:s.message)}},P=async(r,s)=>{try{let p=f,M=new FormData;M.append("file",s),await nr(r,M);let F=new FileReader;F.readAsDataURL(s),F.onloadend=()=>{let Z=F.result;if(typeof Z!="string")return;let I={...b};I.slides[p].canvas.image=Z.replace("data:image/png;base64,",""),$(I)}}catch(p){V.error(p==null?void 0:p.message)}},_e=r=>{T(r)},fe=()=>{T(null)},ve=()=>{},be=async()=>{if(!(!z||!N||!C||!d||d.length===0))try{let r=d[f].shapes.findIndex(({_id:p})=>p===C);if(r===-1)return;await tr(z,{slideId:N,shapeId:C});let s={...b};s.slides[f].shapes.splice(r,1),$(s),T(null)}catch(r){V.error(r==null?void 0:r.message)}},we=l.useMemo(()=>{let r="";return o===0?r=`/cursor/color-${g}.png`:o===1?r="/cursor/color-3.png":o===6&&(r="/cursor/color-5.png"),r?`url(${J(r)}), auto`:o===4?"crosshair":"default"},[o,g]),je=({pageX:r,pageY:s})=>{if(!v.current||!N)return;let{width:p,height:M,left:F,top:Z}=v.current.getBoundingClientRect(),{clientWidth:I,clientHeight:Q}=v.current,re=I/p,le=Q/M,oe=o==5,ie={slideId:N,shape:{type:oe?"text-box":he[h].type,props:{width:oe?250:1,height:oe?150:1,rotate:0,translateX:(r-F)*re,translateY:(s-Z)*le,borderColor:H.borderColor,backgroundColor:H.backgroundColor}}};X.current={pageX:r,pageY:s},Y(ie),window.addEventListener("mousemove",Me),window.addEventListener("mouseup",Je,{once:!0})},Me=({pageX:r,pageY:s})=>{Y(p=>{if(!p||!v.current)return p;let{width:M,height:F,left:Z,top:I}=v.current.getBoundingClientRect(),{clientWidth:Q,clientHeight:re}=v.current,le=Q/M,oe=re/F,ie={...p},{shape:{props:K}}=ie,De=r-X.current.pageX,Ee=s-X.current.pageY;return K.width=Math.abs(De)*le,K.height=Math.abs(Ee)*oe,De<0&&(K.translateX=le*(X.current.pageX-Z)-K.width),Ee<0&&(K.translateY=le*(X.current.pageY-I)-K.height),ie})},Je=()=>{window.removeEventListener("mousemove",Me),Y(r=>(r&&Ke(r.shape),r))},Qe=async r=>{try{let s=d[f].shapes.findIndex(({_id:M})=>M===r._id);if(s===-1)return;await Ae(r._id,r);let p={...b};p.slides[f].shapes[s].props=r.props,$(p)}catch(s){V.error(s==null?void 0:s.message)}},Ke=async r=>{if(!z||!N)return;let s={type:r.type,props:r.props};try{let{data:{data:p}}=await er(z,{slideId:N},s),M={...b};M.slides[f].shapes.push(p),$(M),T(p._id),Y(null),i(2)}catch(p){V.error(p==null?void 0:p.message)}},et=async r=>{if(z)try{let{data:{data:s}}=await jn(z,{position:r}),p={...b};p.slides.splice(r,0,s),$(p),R(r)}catch(s){V.error(s==null?void 0:s.message)}},tt=async r=>{if(z)try{let s=d.findIndex(({_id:M})=>M===r);if(s===-1)return;await Jn(z,{slideId:r});let p={...b};p.slides.splice(s,1),$(p),r===N&&R(0)}catch(s){V.error(s==null?void 0:s.message)}},nt=async r=>{if(z)try{await ht(z,{title:r}),ke(),$({...b,title:r})}catch(s){V.error(s==null?void 0:s.message)}},ke=()=>{y(!w)},rt=async r=>{if(!z||!N)return;let s=f;try{await Kn(z,{slideId:N},{backgroundImage:r});let p={...b};p.slides[s].props={backgroundImage:r},$(p)}catch(p){V.error(p==null?void 0:p.message)}},ze=async(r,s)=>{if(!C)return;let p=f;try{let M=d[f].shapes,F=M.findIndex(({_id:re})=>re===C);if(F===-1)return;let Z=M[F];if(Z.props[r]===s)return;let I={...Z};I.props[r]=s,await Ae(C,I);let Q={...b};Q.slides[p].shapes[F]=I,$(Q),L({...H,[r]:s})}catch(M){V.error(M==null?void 0:M.message)}},lt=l.useMemo(()=>{if(!(!d||d.length===0))return d[f].props.backgroundImage},[f,d]);return u(l.Fragment,{children:[e(ft,{user:t,title:S,logout:n,toggleTitle:ke,children:e(Rn,{slides:d,activeSlide:f,activeSlideId:N,dimension:j,onSlideChange:R,onAddSlide:et,onDeleteSlide:tt})}),e(tn,{tool:o,shape:h,sketch:m,sketchColor:g,slideBackGround:lt,borderColor:H.borderColor,backgroundColor:H.backgroundColor,selectedShapeId:C,onSelectTool:i,onSelectShape:a,onSelectSketch:c,onClearSlide:B,onSelectSketchColor:_,onSelectBackGround:rt,onSelectBorderColor:ze,onSelectBackGroundColor:ze}),e("div",{ref:E,className:ue.container,children:d&&d.length>0&&d.map(r=>e("div",{className:ue.slide,children:u("div",{"data-slide":r._id,className:ue.board,style:{cursor:we,width:j.width,height:j.height,transform:`scale(${k.x},${k.y}) translate(-50%, -50%)`,backgroundImage:`url(/background/${J(r.props.backgroundImage)}.png)`},...[4,5].includes(o)&&{onMouseDown:je},children:[e(ln,{tool:o,sketch:m,sketchColor:g,canvas:r.canvas,dimension:ae,onUpdateCanvas:P,isActiveSlide:r._id===N}),r.shapes&&r.shapes.map(s=>e(Ln,{shape:s,selectedShapeId:C,onClick:_e,onBlur:fe,onUpdateShape:Qe},s._id)),A&&A.slideId===r._id&&e(Pe,{shape:A.shape})]})},r._id))}),u(ne,{selector:`button[shape-id='${C}']`,className:ue.shape_dropdown,placement:"bottom","aria-disabled":!!C,children:[u(ne.Item,{onClick:ve,children:[e("i",{className:"bx-duplicate"}),e("span",{children:"Duplicate"})]}),u(ne.Item,{onClick:be,children:[e("i",{className:"bx-trash"}),e("span",{children:"Delete"})]})]}),e(Pn,{title:S,isOpen:w,toggle:ke,onSubmit:nt})]})};export{ur as default};
